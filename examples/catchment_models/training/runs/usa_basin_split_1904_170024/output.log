2024-04-19 17:00:24,488: Logging to /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/usa_basin_split_1904_170024/output.log initialized.
2024-04-19 17:00:24,489: ### Folder structure created at /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/usa_basin_split_1904_170024
2024-04-19 17:00:24,489: ### Run configurations for usa_basin_split
2024-04-19 17:00:24,489: experiment_name: usa_basin_split
2024-04-19 17:00:24,489: train_basin_file: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data/basin_lists/usa_basin_split_train_list.txt
2024-04-19 17:00:24,489: validation_basin_file: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data/basin_lists/usa_basin_split_train_list.txt
2024-04-19 17:00:24,489: test_basin_file: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data/basin_lists/usa_basin_split_test_list.txt
2024-04-19 17:00:24,489: train_start_date: 1999-10-01 00:00:00
2024-04-19 17:00:24,489: train_end_date: 2009-09-30 00:00:00
2024-04-19 17:00:24,490: validation_start_date: 1989-10-01 00:00:00
2024-04-19 17:00:24,490: validation_end_date: 1999-09-30 00:00:00
2024-04-19 17:00:24,490: test_start_date: 1999-10-01 00:00:00
2024-04-19 17:00:24,490: test_end_date: 2009-09-30 00:00:00
2024-04-19 17:00:24,490: seed: 123
2024-04-19 17:00:24,490: device: cuda:0
2024-04-19 17:00:24,490: allow_subsequent_nan_losses: 5
2024-04-19 17:00:24,490: validate_every: 2
2024-04-19 17:00:24,490: validate_n_random_basins: 1000
2024-04-19 17:00:24,490: metrics: ['NSE']
2024-04-19 17:00:24,491: model: cudalstm
2024-04-19 17:00:24,491: head: regression
2024-04-19 17:00:24,491: hidden_size: 128
2024-04-19 17:00:24,491: initial_forget_bias: 3
2024-04-19 17:00:24,491: output_dropout: 0.4
2024-04-19 17:00:24,491: output_activation: linear
2024-04-19 17:00:24,491: optimizer: Adam
2024-04-19 17:00:24,491: loss: NSE
2024-04-19 17:00:24,491: learning_rate: {0: 0.001, 21: 0.0001, 31: 1e-05}
2024-04-19 17:00:24,491: batch_size: 256
2024-04-19 17:00:24,491: epochs: 5
2024-04-19 17:00:24,492: clip_gradient_norm: 1
2024-04-19 17:00:24,492: predict_last_n: 1
2024-04-19 17:00:24,492: seq_length: 270
2024-04-19 17:00:24,492: num_workers: 1
2024-04-19 17:00:24,492: log_interval: 50
2024-04-19 17:00:24,492: log_tensorboard: True
2024-04-19 17:00:24,492: save_weights_every: 1
2024-04-19 17:00:24,492: save_validation_results: True
2024-04-19 17:00:24,492: dataset: era5_grdc_sheds
2024-04-19 17:00:24,492: data_dir: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data
2024-04-19 17:00:24,493: dynamic_inputs: ['sro_sum', 'ssro_sum', 'sp_mean', 't2m_mean', 'str_mean']
2024-04-19 17:00:24,493: target_variables: ['streamflow']
2024-04-19 17:00:24,493: static_attributes: ['pre_mm_syr', 'ari_ix_sav', 'area', 'ele_mt_sav', 'snw_pc_syr', 'slp_dg_sav', 'kar_pc_sse', 'cly_pc_sav', 'pet_mm_syr', 'for_pc_sse', 'snd_pc_sav', 'slt_pc_sav', 'gwt_cm_sav', 'run_mm_syr', 'soc_th_sav', 'swc_pc_syr', 'sgr_dk_sav', 'cmi_ix_syr']
2024-04-19 17:00:24,493: number_of_basins: 296
2024-04-19 17:00:24,493: run_dir: /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/usa_basin_split_1904_170024
2024-04-19 17:00:24,493: train_dir: /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/usa_basin_split_1904_170024/train_data
2024-04-19 17:00:24,493: img_log_dir: /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/usa_basin_split_1904_170024/img_log
2024-04-19 17:00:24,507: ### Device cuda:0 will be used for training
2024-04-19 17:00:24,860: Loading basin data into xarray data set.
2024-04-19 17:00:40,535: Calculating target variable stds per basin
2024-04-19 17:00:40,865: Create lookup table and convert to pytorch tensor
2024-04-19 17:02:28,125: Epoch 1 average loss: avg_loss: 0.00072, avg_total_loss: 0.00072
2024-04-19 17:03:57,713: Epoch 2 average loss: avg_loss: 0.00006, avg_total_loss: 0.00006
2024-04-19 17:04:20,400: The following basins had not enough valid target values to calculate a standard deviation: 7060045480. NSE loss values for this basin will be NaN.
2024-04-19 17:04:24,264: The following basins had not enough valid target values to calculate a standard deviation: 7060334030. NSE loss values for this basin will be NaN.
2024-04-19 17:04:56,235: The following basins had not enough valid target values to calculate a standard deviation: 7060589830. NSE loss values for this basin will be NaN.
2024-04-19 17:05:08,385: The following basins had not enough valid target values to calculate a standard deviation: 7060746040. NSE loss values for this basin will be NaN.
2024-04-19 17:06:23,406: The following basins had not enough valid target values to calculate a standard deviation: 8070086350. NSE loss values for this basin will be NaN.
2024-04-19 17:06:26,230: Stored results at /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/usa_basin_split_1904_170024/validation/model_epoch002/validation_results.p
2024-04-19 17:06:26,235: Epoch 2 average validation loss: 0.00003 -- Median validation metrics: avg_loss: 0.00003, NSE: 0.01361
2024-04-19 17:07:56,390: Epoch 3 average loss: avg_loss: 0.00004, avg_total_loss: 0.00004
2024-04-19 17:09:27,329: Epoch 4 average loss: avg_loss: 0.00002, avg_total_loss: 0.00002
2024-04-19 17:11:17,454: Stored results at /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/usa_basin_split_1904_170024/validation/model_epoch004/validation_results.p
2024-04-19 17:11:17,460: Epoch 4 average validation loss: 0.00004 -- Median validation metrics: avg_loss: 0.00004, NSE: 0.18310
2024-04-19 17:12:51,500: Epoch 5 average loss: avg_loss: 0.00002, avg_total_loss: 0.00002
