2024-04-20 13:53:01,933: Logging to /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/globe_time_split_2004_135301/output.log initialized.
2024-04-20 13:53:01,933: ### Folder structure created at /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/globe_time_split_2004_135301
2024-04-20 13:53:01,933: ### Run configurations for globe_time_split
2024-04-20 13:53:01,933: experiment_name: globe_time_split
2024-04-20 13:53:01,933: train_basin_file: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data/basin_lists/globe_time_split_list.txt
2024-04-20 13:53:01,933: validation_basin_file: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data/basin_lists/globe_time_split_list.txt
2024-04-20 13:53:01,933: test_basin_file: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data/basin_lists/globe_time_split_list.txt
2024-04-20 13:53:01,933: train_start_date: 1999-10-01 00:00:00
2024-04-20 13:53:01,934: train_end_date: 2009-09-30 00:00:00
2024-04-20 13:53:01,934: validation_start_date: 2009-10-01 00:00:00
2024-04-20 13:53:01,934: validation_end_date: 2019-09-30 00:00:00
2024-04-20 13:53:01,934: test_start_date: 1989-10-01 00:00:00
2024-04-20 13:53:01,934: test_end_date: 1999-09-30 00:00:00
2024-04-20 13:53:01,934: seed: 123
2024-04-20 13:53:01,934: device: cuda:0
2024-04-20 13:53:01,934: allow_subsequent_nan_losses: 5
2024-04-20 13:53:01,934: validate_every: 2
2024-04-20 13:53:01,934: validate_n_random_basins: 500
2024-04-20 13:53:01,934: metrics: ['NSE']
2024-04-20 13:53:01,934: model: cudalstm
2024-04-20 13:53:01,935: head: regression
2024-04-20 13:53:01,935: hidden_size: 128
2024-04-20 13:53:01,935: initial_forget_bias: 3
2024-04-20 13:53:01,935: output_dropout: 0.4
2024-04-20 13:53:01,935: output_activation: linear
2024-04-20 13:53:01,935: optimizer: Adam
2024-04-20 13:53:01,935: loss: NSE
2024-04-20 13:53:01,935: learning_rate: {0: 0.001, 21: 0.0001, 31: 1e-05}
2024-04-20 13:53:01,935: batch_size: 256
2024-04-20 13:53:01,935: epochs: 5
2024-04-20 13:53:01,935: clip_gradient_norm: 1
2024-04-20 13:53:01,935: predict_last_n: 1
2024-04-20 13:53:01,936: seq_length: 270
2024-04-20 13:53:01,936: num_workers: 1
2024-04-20 13:53:01,936: log_interval: 50
2024-04-20 13:53:01,936: log_tensorboard: True
2024-04-20 13:53:01,936: save_weights_every: 1
2024-04-20 13:53:01,936: save_validation_results: True
2024-04-20 13:53:01,936: dataset: era5_grdc_sheds
2024-04-20 13:53:01,936: data_dir: /home/achiang/CliMA/Rivers_odunbar/data_from_sampo/single_model_data
2024-04-20 13:53:01,936: dynamic_inputs: ['sro_sum', 'ssro_sum', 'sp_mean', 't2m_mean', 'str_mean']
2024-04-20 13:53:01,936: target_variables: ['streamflow']
2024-04-20 13:53:01,936: static_attributes: ['pre_mm_syr', 'ari_ix_sav', 'area', 'ele_mt_sav', 'snw_pc_syr', 'slp_dg_sav', 'kar_pc_sse', 'cly_pc_sav', 'pet_mm_syr', 'for_pc_sse', 'snd_pc_sav', 'slt_pc_sav', 'gwt_cm_sav', 'run_mm_syr', 'soc_th_sav', 'swc_pc_syr', 'sgr_dk_sav', 'cmi_ix_syr']
2024-04-20 13:53:01,937: number_of_basins: 1326
2024-04-20 13:53:01,937: run_dir: /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/globe_time_split_2004_135301
2024-04-20 13:53:01,937: train_dir: /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/globe_time_split_2004_135301/train_data
2024-04-20 13:53:01,937: img_log_dir: /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/globe_time_split_2004_135301/img_log
2024-04-20 13:53:01,962: ### Device cuda:0 will be used for training
2024-04-20 13:53:02,579: Loading basin data into xarray data set.
2024-04-20 13:54:17,227: Calculating target variable stds per basin
2024-04-20 13:54:18,325: The following basins had not enough valid target values to calculate a standard deviation: 5070068140. NSE loss values for this basin will be NaN.
2024-04-20 13:54:18,651: Create lookup table and convert to pytorch tensor
2024-04-20 13:55:02,599: These basins do not have a single valid sample in the train period: ['5070068140']
2024-04-20 14:01:34,777: Epoch 1 average loss: avg_loss: 0.00022, avg_total_loss: 0.00022
2024-04-20 14:08:08,911: Epoch 2 average loss: avg_loss: 0.00001, avg_total_loss: 0.00001
2024-04-20 14:08:14,816: The following basins had not enough valid target values to calculate a standard deviation: 7070583100. NSE loss values for this basin will be NaN.
2024-04-20 14:08:16,131: The following basins had not enough valid target values to calculate a standard deviation: 1051315930. NSE loss values for this basin will be NaN.
2024-04-20 14:08:17,417: The following basins had not enough valid target values to calculate a standard deviation: 1070030310. NSE loss values for this basin will be NaN.
2024-04-20 14:08:27,630: The following basins had not enough valid target values to calculate a standard deviation: 2060253060. NSE loss values for this basin will be NaN.
2024-04-20 14:08:34,905: The following basins had not enough valid target values to calculate a standard deviation: 4060043170. NSE loss values for this basin will be NaN.
2024-04-20 14:08:37,482: The following basins had not enough valid target values to calculate a standard deviation: 4070040780. NSE loss values for this basin will be NaN.
2024-04-20 14:08:41,551: The following basins had not enough valid target values to calculate a standard deviation: 7070048050. NSE loss values for this basin will be NaN.
2024-04-20 14:08:43,112: The following basins had not enough valid target values to calculate a standard deviation: 7070046720. NSE loss values for this basin will be NaN.
2024-04-20 14:08:57,104: The following basins had not enough valid target values to calculate a standard deviation: 6070736450. NSE loss values for this basin will be NaN.
2024-04-20 14:09:01,858: The following basins had not enough valid target values to calculate a standard deviation: 5070603610. NSE loss values for this basin will be NaN.
2024-04-20 14:09:08,690: The following basins had not enough valid target values to calculate a standard deviation: 4070037560. NSE loss values for this basin will be NaN.
2024-04-20 14:09:17,068: The following basins had not enough valid target values to calculate a standard deviation: 6060736450. NSE loss values for this basin will be NaN.
2024-04-20 14:09:20,526: The following basins had not enough valid target values to calculate a standard deviation: 6060033220. NSE loss values for this basin will be NaN.
2024-04-20 14:09:24,602: The following basins had not enough valid target values to calculate a standard deviation: 6070620420. NSE loss values for this basin will be NaN.
2024-04-20 14:09:34,464: The following basins had not enough valid target values to calculate a standard deviation: 4070021260. NSE loss values for this basin will be NaN.
2024-04-20 14:09:36,057: The following basins had not enough valid target values to calculate a standard deviation: 4070039600. NSE loss values for this basin will be NaN.
2024-04-20 14:09:38,575: The following basins had not enough valid target values to calculate a standard deviation: 7050006910. NSE loss values for this basin will be NaN.
2024-04-20 14:09:41,117: The following basins had not enough valid target values to calculate a standard deviation: 5070517640. NSE loss values for this basin will be NaN.
2024-04-20 14:09:43,703: The following basins had not enough valid target values to calculate a standard deviation: 7060046600. NSE loss values for this basin will be NaN.
2024-04-20 14:09:50,991: The following basins had not enough valid target values to calculate a standard deviation: 1050792830. NSE loss values for this basin will be NaN.
2024-04-20 14:09:54,497: The following basins had not enough valid target values to calculate a standard deviation: 4060039500. NSE loss values for this basin will be NaN.
2024-04-20 14:10:01,718: The following basins had not enough valid target values to calculate a standard deviation: 7060006580. NSE loss values for this basin will be NaN.
2024-04-20 14:10:07,981: The following basins had not enough valid target values to calculate a standard deviation: 1060013820. NSE loss values for this basin will be NaN.
2024-04-20 14:10:10,846: The following basins had not enough valid target values to calculate a standard deviation: 4070043230. NSE loss values for this basin will be NaN.
2024-04-20 14:10:12,120: The following basins had not enough valid target values to calculate a standard deviation: 7060005800. NSE loss values for this basin will be NaN.
2024-04-20 14:10:13,710: The following basins had not enough valid target values to calculate a standard deviation: 4070041260. NSE loss values for this basin will be NaN.
2024-04-20 14:10:17,852: The following basins had not enough valid target values to calculate a standard deviation: 6070301080. NSE loss values for this basin will be NaN.
2024-04-20 14:10:20,077: The following basins had not enough valid target values to calculate a standard deviation: 2070030710. NSE loss values for this basin will be NaN.
2024-04-20 14:10:22,587: The following basins had not enough valid target values to calculate a standard deviation: 1071613460. NSE loss values for this basin will be NaN.
2024-04-20 14:10:24,207: The following basins had not enough valid target values to calculate a standard deviation: 7060006420. NSE loss values for this basin will be NaN.
2024-04-20 14:10:27,735: The following basins had not enough valid target values to calculate a standard deviation: 2070313170. NSE loss values for this basin will be NaN.
2024-04-20 14:10:32,821: The following basins had not enough valid target values to calculate a standard deviation: 5070535770. NSE loss values for this basin will be NaN.
2024-04-20 14:10:37,617: The following basins had not enough valid target values to calculate a standard deviation: 2060551950. NSE loss values for this basin will be NaN.
2024-04-20 14:10:38,926: The following basins had not enough valid target values to calculate a standard deviation: 4070040450. NSE loss values for this basin will be NaN.
2024-04-20 14:10:40,562: The following basins had not enough valid target values to calculate a standard deviation: 1070696150. NSE loss values for this basin will be NaN.
2024-04-20 14:10:47,064: The following basins had not enough valid target values to calculate a standard deviation: 2050006110. NSE loss values for this basin will be NaN.
2024-04-20 14:10:51,789: The following basins had not enough valid target values to calculate a standard deviation: 7060450950. NSE loss values for this basin will be NaN.
2024-04-20 14:10:54,029: The following basins had not enough valid target values to calculate a standard deviation: 7050024890. NSE loss values for this basin will be NaN.
2024-04-20 14:10:56,065: The following basins had not enough valid target values to calculate a standard deviation: 2060284350. NSE loss values for this basin will be NaN.
2024-04-20 14:10:57,954: The following basins had not enough valid target values to calculate a standard deviation: 2070515100. NSE loss values for this basin will be NaN.
2024-04-20 14:11:09,490: The following basins had not enough valid target values to calculate a standard deviation: 4070042870. NSE loss values for this basin will be NaN.
2024-04-20 14:11:14,539: The following basins had not enough valid target values to calculate a standard deviation: 1070874990. NSE loss values for this basin will be NaN.
2024-04-20 14:11:25,530: The following basins had not enough valid target values to calculate a standard deviation: 4070038460. NSE loss values for this basin will be NaN.
2024-04-20 14:11:29,906: The following basins had not enough valid target values to calculate a standard deviation: 6070428760. NSE loss values for this basin will be NaN.
2024-04-20 14:11:31,196: The following basins had not enough valid target values to calculate a standard deviation: 5070067870. NSE loss values for this basin will be NaN.
2024-04-20 14:11:33,403: Stored results at /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/globe_time_split_2004_135301/validation/model_epoch002/validation_results.p
2024-04-20 14:11:33,414: Epoch 2 average validation loss: 0.00033 -- Median validation metrics: avg_loss: 0.00033, NSE: 0.15835
2024-04-20 14:18:12,977: Epoch 3 average loss: avg_loss: 0.00001, avg_total_loss: 0.00001
2024-04-20 14:24:46,242: Epoch 4 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
2024-04-20 14:24:57,022: The following basins had not enough valid target values to calculate a standard deviation: 7050006420. NSE loss values for this basin will be NaN.
2024-04-20 14:24:59,386: The following basins had not enough valid target values to calculate a standard deviation: 5070056190. NSE loss values for this basin will be NaN.
2024-04-20 14:25:00,817: The following basins had not enough valid target values to calculate a standard deviation: 6070183080. NSE loss values for this basin will be NaN.
2024-04-20 14:25:02,104: The following basins had not enough valid target values to calculate a standard deviation: 7060005730. NSE loss values for this basin will be NaN.
2024-04-20 14:25:10,654: The following basins had not enough valid target values to calculate a standard deviation: 6050033220. NSE loss values for this basin will be NaN.
2024-04-20 14:25:12,123: The following basins had not enough valid target values to calculate a standard deviation: 4060021260. NSE loss values for this basin will be NaN.
2024-04-20 14:25:26,433: The following basins had not enough valid target values to calculate a standard deviation: 4070577540. NSE loss values for this basin will be NaN.
2024-04-20 14:25:35,045: The following basins had not enough valid target values to calculate a standard deviation: 4060039730. NSE loss values for this basin will be NaN.
2024-04-20 14:25:46,124: The following basins had not enough valid target values to calculate a standard deviation: 4070041030. NSE loss values for this basin will be NaN.
2024-04-20 14:25:52,801: The following basins had not enough valid target values to calculate a standard deviation: 2050027320. NSE loss values for this basin will be NaN.
2024-04-20 14:25:54,241: The following basins had not enough valid target values to calculate a standard deviation: 4070562450. NSE loss values for this basin will be NaN.
2024-04-20 14:26:02,418: The following basins had not enough valid target values to calculate a standard deviation: 7070494410. NSE loss values for this basin will be NaN.
2024-04-20 14:26:15,085: The following basins had not enough valid target values to calculate a standard deviation: 4070039500. NSE loss values for this basin will be NaN.
2024-04-20 14:26:19,379: The following basins had not enough valid target values to calculate a standard deviation: 6060470810. NSE loss values for this basin will be NaN.
2024-04-20 14:26:20,673: The following basins had not enough valid target values to calculate a standard deviation: 4060040450. NSE loss values for this basin will be NaN.
2024-04-20 14:26:23,075: The following basins had not enough valid target values to calculate a standard deviation: 7050046600. NSE loss values for this basin will be NaN.
2024-04-20 14:26:28,662: The following basins had not enough valid target values to calculate a standard deviation: 2070253060. NSE loss values for this basin will be NaN.
2024-04-20 14:26:32,028: The following basins had not enough valid target values to calculate a standard deviation: 6070453500. NSE loss values for this basin will be NaN.
2024-04-20 14:26:37,751: The following basins had not enough valid target values to calculate a standard deviation: 6060453500. NSE loss values for this basin will be NaN.
2024-04-20 14:26:55,880: The following basins had not enough valid target values to calculate a standard deviation: 6060525240. NSE loss values for this basin will be NaN.
2024-04-20 14:27:07,820: The following basins had not enough valid target values to calculate a standard deviation: 4070043490. NSE loss values for this basin will be NaN.
2024-04-20 14:27:10,328: The following basins had not enough valid target values to calculate a standard deviation: 7060006910. NSE loss values for this basin will be NaN.
2024-04-20 14:27:16,095: The following basins had not enough valid target values to calculate a standard deviation: 1070807450. NSE loss values for this basin will be NaN.
2024-04-20 14:27:26,614: The following basins had not enough valid target values to calculate a standard deviation: 7070450950. NSE loss values for this basin will be NaN.
2024-04-20 14:27:29,152: The following basins had not enough valid target values to calculate a standard deviation: 2060520280. NSE loss values for this basin will be NaN.
2024-04-20 14:27:30,427: The following basins had not enough valid target values to calculate a standard deviation: 6050287830. NSE loss values for this basin will be NaN.
2024-04-20 14:27:35,448: The following basins had not enough valid target values to calculate a standard deviation: 2070609250. NSE loss values for this basin will be NaN.
2024-04-20 14:27:39,903: Stored results at /central/home/achiang/CliMA/Rivers/examples/catchment_models/training/runs/globe_time_split_2004_135301/validation/model_epoch004/validation_results.p
2024-04-20 14:27:39,912: Epoch 4 average validation loss: 0.00001 -- Median validation metrics: avg_loss: 0.00001, NSE: 0.41863
2024-04-20 14:34:13,764: Epoch 5 average loss: avg_loss: 0.00000, avg_total_loss: 0.00000
